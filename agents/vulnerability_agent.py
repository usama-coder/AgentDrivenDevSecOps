from chains.scan_chain import scan_chain
from chains.remediation_chain import run_remediation_chain


def handle_vulnerability():
    """
    Orchestrates the scanning and remediation of vulnerabilities.
    """
    # Get the report from scan_chain
    report = scan_chain()

    for issue in report['issues']:
        # Updated to use issue_text instead of title if title is unavailable
        vulnerable_code = issue.get('code', "Code snippet not provided")
        vulnerability_description = issue.get('issue_text', "Description not provided")

        print(f"Vulnerability: {vulnerability_description}")

        # Run the remediation chain on each vulnerable code snippet
        remediation = run_remediation_chain(vulnerable_code)

        print("Vulnerable Code:")
        print(vulnerable_code)
        print("\nRecommended Fix:")
        print(remediation)
        print("\n" + "-" * 40 + "\n")

